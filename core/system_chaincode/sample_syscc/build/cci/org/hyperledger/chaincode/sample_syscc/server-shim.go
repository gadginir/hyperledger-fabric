/* Generated by chaintool.  DO NOT EDIT */

package sample_syscc

import (
	"errors"
	proto "github.com/golang/protobuf/jsonpb"
	"github.com/hyperledger/fabric/core/chaincode/shim"
	"github.com/hyperledger/fabric/core/system_chaincode/sample_syscc/build/ccs/stub"
)

type CCInterface interface {
	PutVal(*shim.ChaincodeStub, *KeyValue) error
	GetVal(*shim.ChaincodeStub, *Item) (*Item, error)
}

type StubImpl struct {
	Interface CCInterface
}

// Factory mechanics
type FactoryImpl struct {
}

func init() {
	self := &FactoryImpl{}
	stub.Register("org.hyperledger.chaincode.sample_syscc", self)
}

func (self *FactoryImpl) Create(intf interface{}) (stub.Dispatcher, error) {
	return &StubImpl{Interface: intf.(CCInterface)}, nil
}

func (self *StubImpl) DispatchTxn(stub *shim.ChaincodeStub, function int, params string) ([]byte, error) {
	// Handle different functions
	switch {
	case function == 1:
		return self.PutValStub(stub, params)
	default:
		return nil, errors.New("Received unknown function invocation")
	}
}

func (self *StubImpl) DispatchQuery(stub *shim.ChaincodeStub, function int, params string) ([]byte, error) {
	// Handle different functions
	switch {
	case function == 1:
		return self.GetValStub(stub, params)
	default:
		return nil, errors.New("Received unknown function invocation")
	}
}

/* Server stubs */
func (self *StubImpl) PutValStub(stub *shim.ChaincodeStub, _params string) ([]byte, error) {

	params := &KeyValue{}
	err := proto.UnmarshalString(_params, params)
	if err != nil {
		return nil, err
	}

	err = self.Interface.PutVal(stub, params)
	if err != nil {
		return nil, err
	}

	return nil, nil
}

func (self *StubImpl) GetValStub(stub *shim.ChaincodeStub, _params string) ([]byte, error) {

	params := &Item{}
	err := proto.UnmarshalString(_params, params)
	if err != nil {
		return nil, err
	}

	result, err := self.Interface.GetVal(stub, params)
	if err != nil {
		return nil, err
	}

	marshaler := &proto.Marshaler{}
	_result, err := marshaler.MarshalToString(result)
	if err != nil {
		return nil, err
	}
	return []byte(_result), nil
}
